#include <stdio.h>
#include <string.h>
#include "types.h"

#define FIELD_SIZE 30
#define TAG_SIZE 3
#define OFFSET -128

typedef struct {
	char title[FIELD_SIZE+1], artist[FIELD_SIZE+1], album[FIELD_SIZE+1];
	genre_t genre;
} track_t;

int main (int argc, char *argv[])
{
	FILE *fi;
	char input, aux[128];
	size_t i;
	track_t track;

	if((fi=fopen(argv[1], "rb"))==NULL) return 1;

	fseek(fi, OFFSET, SEEK_END);
	fread(aux, TAG_SIZE, 1, fi);
	fread(track.title, FIELD_SIZE, 1, fi);
	fread(track.artist, FIELD_SIZE, 1, fi);
	fread(track.album, FIELD_SIZE, 1, fi);
	fread(aux, FIELD_SIZE+5, 1, fi);
	fread(&track.genre, 1, 1, fi); 

	track.title[FIELD_SIZE]=track.artist[FIELD_SIZE]=track.album[FIELD_SIZE]='\0';

	printf("%s\n\t%s\n\t\t%s\n%i\n", track.artist, track.title, track.album, track.genre);

	fclose(fi);
	return 0;
}
